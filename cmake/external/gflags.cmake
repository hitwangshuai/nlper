INCLUDE(ExternalProject)

SET(GFLAGS_SOURCES_DIR ${THIRD_PARTY_PATH}/gflags)
SET(GFLAGS_INSTALL_DIR ${THIRD_PARTY_PATH}/)
ExternalProject_Add(
    extern_gflags
    ${EXTERNAL_PROJECT_LOG_ARGS}
    DOWNLOAD_DIR          ${GFLAGS_SOURCES_DIR}
    DOWNLOAD_COMMAND      cd ${GFLAGS_SOURCES_DIR} && tar zxvf gflags_2_2_1.tar.gz && cd ./gflags
    DOWNLOAD_NO_PROGRESS  1
    PREFIX          ${GFLAGS_SOURCES_DIR}
    UPDATE_COMMAND  ""
    BUILD_COMMAND   cd ${GFLAGS_SOURCES_DIR}/gflags && cmake -DCMAKE_POSITION_INDEPENDENT_CODE=ON -DBUILD_SHARED_LIBS=ON -DBUILD_STATIC_LIBS=ON -DBUILD_TESTING=OFF -DCMAKE_INSTALL_PREFIX=${GFLAGS_INSTALL_DIR} ./ && make -j16
    CONFIGURE_COMMAND ""
    INSTALL_COMMAND cd ${GFLAGS_SOURCES_DIR}/gflags && make install
    BUILD_IN_SOURCE      1
)

